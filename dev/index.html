<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · AllocationOpt.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://graphprotocol.github.io/AllocationOpt.jl/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>AllocationOpt.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Usage"><span>Usage</span></a></li><li><a class="tocitem" href="#Bugs-and-Feature-Requests"><span>Bugs and Feature Requests</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/graphprotocol/AllocationOpt.jl/blob/master/docs/src/index.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="AllocationOpt"><a class="docs-heading-anchor" href="#AllocationOpt">AllocationOpt</a><a id="AllocationOpt-1"></a><a class="docs-heading-anchor-permalink" href="#AllocationOpt" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/graphprotocol/AllocationOpt.jl">AllocationOpt</a>.</p><p>AllocationOpt is a library for optimising how an indexer should allocate its stake in <a href="https://thegraph.com/en/">The Graph Protocol</a>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>You must run this on a computer that supports 64-bit operations. 32-bit doesn&#39;t have enough precision to solve the optimisation problem.</p></div></div><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>Enter the julia repl. On linux machines, this is as simple as running the <code>julia</code> command from your terminal emulator. For MacOS, you&#39;ll need to add Julia to your path. See this <a href="https://stackoverflow.com/questions/72123620/permission-denied-when-i-am-trying-to-add-julia-to-path-in-macos/72308646#72308646">StackOverflow post</a> if you&#39;re having issues. Add this package by adding the github url. First, enter package mode <code>]</code>. Then, type <code>add https://github.com/graphprotocol/AllocationOpt.jl</code>. You&#39;ll also want to add the <a href="https://github.com/comonicon/Comonicon.jl">Comonicon package</a>.</p><pre><code class="language-julia-repl hljs">pkg&gt; add https://github.com/graphprotocol/AllocationOpt.jl/
pkg&gt; add Comonicon</code></pre><h2 id="Usage"><a class="docs-heading-anchor" href="#Usage">Usage</a><a id="Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Usage" title="Permalink"></a></h2><p>Download the <a href="https://raw.githubusercontent.com/graphprotocol/AllocationOpt.jl/main/scripts/allocationopt"><em>allocationopt</em> script</a>. For example, using <code>curl</code> or <code>wget</code>. Make sure you use the raw file!</p><p>Make the <em>allocationopt</em> script executable. </p><pre><code class="language-bash hljs">$ chmod +x allocationopt</code></pre><p>You can further simplify the use of this script by symlinking it to your <em>.local/bin</em>. For MacOS, symlink instead to <em>/usr/local/bin</em>.</p><pre><code class="language-bash hljs">$ mkdir -p ~/.local/bin
$ cd ~/.local/bin
$ ln -s ~/projects/AllocationOpt.jl/scripts/allocationopt .  # Change to the path to the allocationopt script for you</code></pre><p>You should now be able to run the <em>allocationopt</em> script from anywhere!</p><p>The optimiser queries the network subgraph data to optimize. We recommend making queries to the network subgraph served by your own indexer service. Alternatively, you can supply an API url to <code>indexer_service_network_url</code> from the decentralized gateway or hosted service.  To provide the network subgraph to the optimiser, set the indexer-service flag <code>--serve-network-subgraph</code> to <code>true</code>.</p><p>Populate your preferred lists (whitelist, blacklist, pinnedlist, frozenlist) into a CSV and take note of its file path. If you choose to supply specific deployment preferences through this list, please read list definitions in detail and keep the file updated to your expectations as it changes the problem statement for the optimiser. </p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>You can access the help for the optimiser by running the script with the <code>--help</code> flag. For example <code>allocationopt --help</code>.</p></div></div><h3 id="Action-Queue"><a class="docs-heading-anchor" href="#Action-Queue">Action Queue</a><a id="Action-Queue-1"></a><a class="docs-heading-anchor-permalink" href="#Action-Queue" title="Permalink"></a></h3><p>This command requires a URL to the indexer management server and a URL to make graph network subgraph queries.</p><p>Run the <em>allocationopt</em> script with the <em>actionqueue</em> option.</p><pre><code class="language-bash hljs">$ ./scripts/allocationopt actionqueue &quot;0x6ac85b9d834b51b14a7b0ed849bb5199e04c05c5&quot; 1 test/example.csv 50.0 28 30 0.3 http://localhost:18000 http://localhost:7600/network</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>You can access the help for the <em>actionqueue</em> option of the optimiser by running <code>allocationopt actionqueue --help</code> from your terminal. The help contains more details about each of the arguments of the optimiser.</p></div></div><p>Requests from our tool are logged, and you can use the indexer CLI <code>actions</code> commands to check and approve actions.  We do NOT auto-approve actions on your behalf.</p><h3 id="Indexing-Rules"><a class="docs-heading-anchor" href="#Indexing-Rules">Indexing Rules</a><a id="Indexing-Rules-1"></a><a class="docs-heading-anchor-permalink" href="#Indexing-Rules" title="Permalink"></a></h3><p>If you don&#39;t have the action queue set up yet, you can also run the optimiser by telling it to generate indexing rules. </p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Under this setup, you must pay attention to the order in which you execute the rules. If you do not close existing allocations before opening new ones, you won&#39;t have enough capital to open your new allocations.</p></div></div><p>Run the <em>allocationopt</em> script with the <em>rules</em> option. The URL passed in should be an API URL</p><pre><code class="language-bash hljs">$ ./scripts/allocationopt rules &quot;0x6ac85b9d834b51b14a7b0ed849bb5199e04c05c5&quot; 1 test/example.csv 50.0 28 25 0.3 http://localhost:7600/network</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>You can access the help for the <em>rules</em> option of the optimiser by running <code>allocationopt rules --help</code> from your terminal. The help contains more details about each of the arguments of the optimiser.</p></div></div><h2 id="Bugs-and-Feature-Requests"><a class="docs-heading-anchor" href="#Bugs-and-Feature-Requests">Bugs and Feature Requests</a><a id="Bugs-and-Feature-Requests-1"></a><a class="docs-heading-anchor-permalink" href="#Bugs-and-Feature-Requests" title="Permalink"></a></h2><p>Please submit bug reports/feature requests to our <a href="https://github.com/graphprotocol/AllocationOpt.jl/issues">issue tracker</a>.</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Thursday 8 September 2022 17:30">Thursday 8 September 2022</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
